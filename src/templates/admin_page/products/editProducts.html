<!DOCTYPE html>
<html lang="en">
{% load static %}
{% load widget_tweaks %}

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="{% static 'css/fontawesome-free-6.0.0-beta3-web/css/all.css' %}">
    <link rel="stylesheet" href="{% static 'css/admin_css/main_copy.css' %}">
    <link rel="stylesheet" href="{% static 'css/admin_css/products.css' %}">
    <link rel="stylesheet" href="{% static 'css/admin_css/addProducts.css' %}">
    <link rel="stylesheet" href="{% static 'css/admin_css/brands.css' %}">
    <link rel="stylesheet" href="{% static 'css/admin_css/perItem.css' %}">
    <link rel="stylesheet" href="{% static 'css/admin_css/account.css' %}">
    <link rel="stylesheet" href="{% static 'css/admin_css/collapseCSSZ.css' %}">

    <link rel="stylesheet" href="{% static 'css/admin_css/toastr.min.css' %}">

    <title>Dashboard: Add Order</title>
</head>

<style>
    #empty_form{
        display: none;
    }
</style>

<body>

{% if messages %}
<ul class="messages">
    {% for message in messages %}
            {% if message.tags == 'success'%}
                <script type=text/javascript>toastr.{{ message.tags }}('{{ message }}')</script>
            {% elif message.tags == 'info' %}
                <script type=text/javascript>toastr.{{ message.tags }}('{{ message }}')</script>
            {% elif message.tags == 'warning' %}
                <script type=text/javascript>toastr.{{ message.tags }}('{{ message }}')</script>
            {% elif message.tags == 'error' %}
                <script type=text/javascript>toastr.{{ message.tags }}('{{ message }}')</script>
            {% endif %}
    {% endfor %}
</ul>
{% endif %}

    <!-- navigation bar start -->
    <div class="sc_navbar">
        <div class="sc_header">
            <div class="sc_header_right">
                <a href="#home" class="admin_hello">Hello {{request.user}}</a>
                <a href="{% url 'index_vendor_admin_page' %}" class="admin_hello" style="margin: 0px 5px;">Go to Vendor Portal</a>
                <a href="{% url 'logged_out_admin' %}" class="logout_btn">Logout</a>
            </div>
        </div>
    </div>
    <!-- navigation bar End -->

    <!-- side bar start -->
    <div class="sc_sidebar_list">
        <div class="sc_sidebar">
            <a href="{% url 'index_admin' %}"><i class="fas fa-rupee-sign"></i>Dashboard</a>
            <a class="active" href="{% url 'sb_product_admin' %}"><i class="fas fa-barcode"></i>Products</a>
            <a href="{% url 'sb_images_admin' %}"><i class="fas fa-plus-circle"></i>Images</a>
            <a href="{% url 'sb_ads_admin' %}"><i class="fas fa-mitten"></i>Ads</a>
            <a href="{% url 'sb_account_admin' %}"><i class="fas fa-users"></i>User Accounts</a>
            <a href="{% url 'sb_blog_admin' %}"><i class="fa-brands fa-blogger"></i>Blog</a>
        </div>
    </div>

    <!-- side bar End -->


    <!-- staff details topbar start -->

    <div class="sc_staff_nav">
        <div class="sc_staffs_topbar">
            <div class="sc_staffs_status" onclick="openPage('editProducts_tab', this)" id="defaultOpen">Products Details</a></div>            
        </div>
    </div>

    <!-- staff details topbar end -->

    <div class="sc_content_container_noBorder sc_cc_tab" id="editProducts_tab">
    <div class="admin_addbrand_title">
            <a href="{% url 'sb_product_admin' %}"><i class="far fa-arrow-alt-circle-left"></i></a>
            <h1>Product Details</h1>
        </div>

        <div class="admin_addProduct_main">
            <form action="/admin_django/sb_edit_product_post/{{product_type}}/{{ids}}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ formset.management_form }}
                {{ formset1.management_form }}

                <div class="add_contentDiv">
                    <div class="add_title margin_tb_auto" for="mcategory">Categories</div>
                    <div class="add_description">
                        {% render_field form_1.categories onchange="handleSelectChange(event);" %}
                    </div>
                </div>

                <div class="add_contentDiv">
                    <div class="add_title margin_tb_auto" for="subcategory">Sub Categories</div>
                    <div class="add_description">
                        {{form_1.sub_categories}}
                    </div>
                </div>

                <div class="add_contentDiv">
                    <div class="add_title margin_tb_auto" for="brand">Brand</div>
                    <div class="add_description">
                        {{form_1.brand}}
                    </div>
                </div>

                <div class="add_contentDiv">
                    <div class="add_title margin_tb_auto" for="product_title">Title</div>
                    <div class="add_description_text">
                        {% render_field form_1.title id="product_title" %}
                    </div>
                </div>

                <div class="add_contentDiv">
                    <div class="add_title margin_tb_auto" for="product_description">Descriptions</div>
                    <div class="add_description_textarea">
                        {{form_1.description}}
                    </div>
                </div>

                <div class="add_contentDiv">
                    <div class="add_title margin_tb_auto" for="product_qty">Quantity</div>
                    <div class="add_description_text">
                        {% render_field form_1.stock id="product_qty" %}
                    </div>
                </div>

                <div class="add_contentDiv">
                    <div class="add_title margin_tb_auto" for="product_lprice">Latest Price</div>
                    <div class="add_description_price">
                        Rs. {% render_field form_1.latest_price id="product_lprice" %}
                    </div>
                </div>

                <div class="add_contentDiv">
                    <div class="add_title margin_tb_auto" for="product_oprice">Old Price</div>
                    <div class="add_description_price">
                        Rs. {% render_field form_1.old_price id="product_oprice" %}
                    </div>
                </div>

                <h1>comming soon</h1>
                {{form_1.coming_soon}}

                <h1>featured product</h1>
                {{form_1.featured_product}}

               <div class="input_img">
                        <label for="file-input">Upload Image</label>
                        {% for items in formset1 %}

                            {% render_field items.photo_img onchange="previewImages(event);" %}

                            <div class="preview">
                                <img id="file-ip-1-preview">
                            </div>
                        {% endfor %}

                </div>

                <div class="add_SpecDiv" style="margin: 50px 0px;">
                    <h2 style="margin: 0;">Product Specification</h2>
                    <hr>

                    <div class="hidden_div" id="empty_form">
                        <div class="add_contentDiv spec_table">
                            <div class="add_title proSpecDropDown">
                                {{ formset.empty_form.title }}
                            </div>
                            <div class="add_description_text">
                                {% render_field formset.empty_form.description id="desc_title" name="desc_title" style="width: 100%;" %}

                            </div>

                            <div class="del_description_tab">
                                <i class="fa-solid fa-xmark" onclick="deleteclone()"></i>
                            </div>
                        </div>
                    </div>

                    <!-- run this in loop for multiple spec list -->
                    <div id="specSheet">
                        {% for form in formset %}
                        <div class="add_contentDiv spec_table" id="perSpecs">
                            <div class="add_title proSpecDropDown" for="product_title">
                                {{form.title}}
                            </div>

                            <div class="add_description_text">
                                {% render_field form.description id="desc_title" name="desc_title" style="width: 100%;" %}
                            </div>

                            <div class="del_description_tab">
                                <i class="fa-solid fa-xmark" onclick=deleteclone()></i>
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    <div class="addSpecDivBtn">
                        <div class="add_product_submit" onclick="addMoreFeature()">Add More</div>
                    </div>

                </div>

                <div class="add_contentDiv_submit">
                    <input class="add_product_submit" name="update" type="submit" value="Update">
                    <input class="add_product_submit" name="delete" type="submit" value="Delete">
                </div>

            </form>
        </div>
    </div>
        <script>

            function addMoreFeature() {
                var parentDiv = document.getElementById('specSheet');
                var totalNewForms = document.getElementById('id_formset-TOTAL_FORMS');
                var currentDescriptionForms = document.getElementsByClassName('spec_table');
                var currentFormCurrent = currentDescriptionForms.length - 1;

                var myDiv = document.getElementById('empty_form');
                var cloneDivs = myDiv.cloneNode(true);
                theName = myDiv.getAttribute('id') + currentFormCurrent;
                cloneDivs.setAttribute('id', theName);
                totalNewForms.setAttribute('value', currentFormCurrent);
                parentDiv.appendChild(cloneDivs);
            }

            function deleteclone(){
                var parentDiv = document.getElementById('specSheet');
                parentDiv.removeChild(parentDiv.lastChild);
            }

            function previewImages(event) {
              var preview = document.getElementById('preview');
              if (this.files) {
                [].forEach.call(this.files, readAndPreview);
              }

              function readAndPreview(file) {
                // Make sure `file.name` matches our extensions criteria
                if (!/\.(jpe?g|png|gif)$/i.test(file.name)) {
                  return alert(file.name + " is not an image");
                } // else...
                var reader = new FileReader();
                reader.addEventListener("load", function() {
                  var image = new Image();
                  image.height = 100;
                  image.title  = file.name;
                  image.src    = this.result;
                  preview.appendChild(image);
                  preview.style.display = "block";
                });
                reader.readAsDataURL(file);
              }

            }
            document.querySelector('#file-input').addEventListener("change", previewImages);
        </script>
    <script src="{% static 'js/admin_page/allproduct.js' %}"></script>
    <script src="{% static 'js/jquery-1.9.1.min.js' %}"></script>
    <script src="{% static 'js/toastr.min.js' %}"></script>
    <script src="{% static 'js/admin_page/edit_sle.js' %}"></script>
</body>

</html>